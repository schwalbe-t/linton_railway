/*
MIT License

Copyright (c) 2017 Uber Technologies, Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

---

math.gl builds on docs and code from "gl-matrix", which is MIT licensed as follows:

Copyright (c) 2015, Brandon Jones, Colin MacKenzie IV.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

--

math.gl builds on docs and code from THREE.js, which is MIT licensed as follows:

The MIT License

Copyright Â© 2010-2017 three.js authors

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

---

math.gl includes certain files from Cesium (https://github.com/AnalyticalGraphicsInc/cesium) under the Apache 2 License:

Copyright 2011-2018 CesiumJS Contributors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and limitations under the License.

Cesium-derived code can be found in the submodule: modules/3d-tiles
 */

/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/@math.gl/core@4.1.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
const t=1/Math.PI*180,r=1/180*Math.PI;globalThis.mathgl=globalThis.mathgl||{config:{EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1}};const n=globalThis.mathgl.config;function s(t){return Object.assign(n,t),n}function e(t,{precision:r=n.precision}={}){return t=function(t){return Math.round(t/n.EPSILON)*n.EPSILON}(t),`${parseFloat(t.toPrecision(r))}`}function i(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function h(t){return"clone"in t?t.clone():t.slice()}function a(t){return u(t)}function o(t){return c(t)}function u(t,n){return x(t,(t=>t*r),n)}function c(r,n){return x(r,(r=>r*t),n)}function l(t,r){return x(t,(t=>Math.sin(t)),r)}function f(t,r){return x(t,(t=>Math.cos(t)),r)}function M(t,r){return x(t,(t=>Math.tan(t)),r)}function m(t,r){return x(t,(t=>Math.asin(t)),r)}function g(t,r){return x(t,(t=>Math.acos(t)),r)}function b(t,r){return x(t,(t=>Math.atan(t)),r)}function d(t,r,n){return x(t,(t=>Math.max(r,Math.min(n,t))))}function p(t,r,n){return i(t)?t.map(((t,s)=>p(t,r[s],n))):n*r+(1-n)*t}function E(t,r,s){const e=n.EPSILON;s&&(n.EPSILON=s);try{if(t===r)return!0;if(i(t)&&i(r)){if(t.length!==r.length)return!1;for(let n=0;n<t.length;++n)if(!E(t[n],r[n]))return!1;return!0}return t&&t.equals?t.equals(r):r&&r.equals?r.equals(t):"number"==typeof t&&"number"==typeof r&&Math.abs(t-r)<=n.EPSILON*Math.max(1,Math.abs(t),Math.abs(r))}finally{n.EPSILON=e}}function O(t,r){if(t===r)return!0;if(t&&"object"==typeof t&&r&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;if(t.exactEquals)return t.exactEquals(r)}if(i(t)&&i(r)){if(t.length!==r.length)return!1;for(let n=0;n<t.length;++n)if(!O(t[n],r[n]))return!1;return!0}return!1}function y(t,r){const s=n.EPSILON;let e;n.EPSILON=t;try{e=r()}finally{n.EPSILON=s}return e}function x(t,r,n){if(i(t)){const s=t;n=n||function(t){return t.clone?t.clone():new Array(t.length)}(s);for(let e=0;e<n.length&&e<s.length;++e){const s="number"==typeof t?t:t[e];n[e]=r(s,e,n)}return n}return r(t)}class k extends Array{clone(){return(new this.constructor).copy(this)}fromArray(t,r=0){for(let n=0;n<this.ELEMENTS;++n)this[n]=t[n+r];return this.check()}toArray(t=[],r=0){for(let n=0;n<this.ELEMENTS;++n)t[r+n]=this[n];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:i(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(n)}formatString(t){let r="";for(let n=0;n<this.ELEMENTS;++n)r+=(n>0?", ":"")+e(this[n],t);return`${t.printTypes?this.constructor.name:""}[${r}]`}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!E(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,n){if(void 0===n)return this.lerp(this,t,r);for(let s=0;s<this.ELEMENTS;++s){const e=t[s],i="number"==typeof r?r:r[s];this[s]=e+n*(i-e)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),r[n]);return this.check()}add(...t){for(const r of t)for(let t=0;t<this.ELEMENTS;++t)this[t]+=r[t];return this.check()}subtract(...t){for(const r of t)for(let t=0;t<this.ELEMENTS;++t)this[t]-=r[t];return this.check()}scale(t){if("number"==typeof t)for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(n.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),r);return this.check()}get elements(){return this}}function L(t){if(!Number.isFinite(t))throw new Error(`Invalid number ${JSON.stringify(t)}`);return t}function S(t,r,s=""){if(n.debug&&!function(t,r){if(t.length!==r)return!1;for(let r=0;r<t.length;++r)if(!Number.isFinite(t[r]))return!1;return!0}(t,r))throw new Error(`math.gl: ${s} some fields set to invalid numbers'`);return t}function w(t,r){if(!t)throw new Error(`math.gl assertion ${r}`)}class R extends k{get x(){return this[0]}set x(t){this[0]=L(t)}get y(){return this[1]}set y(t){this[1]=L(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let n=0;n<this.ELEMENTS;++n){const s=this[n]-t[n];r+=s*s}return L(r)}dot(t){let r=0;for(let n=0;n<this.ELEMENTS;++n)r+=this[n]*t[n];return L(r)}normalize(){const t=this.magnitude();if(0!==t)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(const r of t)for(let t=0;t<this.ELEMENTS;++t)this[t]*=r[t];return this.check()}divide(...t){for(const r of t)for(let t=0;t<this.ELEMENTS;++t)this[t]/=r[t];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return w(t>=0&&t<this.ELEMENTS,"index is out of range"),L(this[t])}setComponent(t,r){return w(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}}const q=1e-6;let N="undefined"!=typeof Float32Array?Float32Array:Array;const A=Math.random;function T(t){return t>=0?Math.round(t):t%.5==0?Math.floor(t):Math.round(t)}function P(){const t=new N(2);return N!=Float32Array&&(t[0]=0,t[1]=0),t}function Z(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t}function I(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t}function Y(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t}function X(t,r){const n=r[0]-t[0],s=r[1]-t[1];return Math.sqrt(n*n+s*s)}function C(t,r){const n=r[0]-t[0],s=r[1]-t[1];return n*n+s*s}function v(t){const r=t[0],n=t[1];return Math.sqrt(r*r+n*n)}function W(t){const r=t[0],n=t[1];return r*r+n*n}function $(t,r,n){const s=r[0],e=r[1];return t[0]=n[0]*s+n[2]*e,t[1]=n[1]*s+n[3]*e,t}function z(t,r,n){const s=r[0],e=r[1];return t[0]=n[0]*s+n[2]*e+n[4],t[1]=n[1]*s+n[3]*e+n[5],t}function j(t,r,n){const s=r[0],e=r[1];return t[0]=n[0]*s+n[3]*e+n[6],t[1]=n[1]*s+n[4]*e+n[7],t}function _(t,r,n){const s=r[0],e=r[1];return t[0]=n[0]*s+n[4]*e+n[12],t[1]=n[1]*s+n[5]*e+n[13],t}const V=v,F=Z,D=I,K=Y,B=X,Q=C,U=W,J=function(){const t=P();return function(r,n,s,e,i,h){let a,o;for(n||(n=2),s||(s=0),o=e?Math.min(e*n+s,r.length):r.length,a=s;a<o;a+=n)t[0]=r[a],t[1]=r[a+1],i(t,t,h),r[a]=t[0],r[a+1]=t[1];return r}}();var G=Object.freeze({__proto__:null,create:P,clone:function(t){const r=new N(2);return r[0]=t[0],r[1]=t[1],r},fromValues:function(t,r){const n=new N(2);return n[0]=t,n[1]=r,n},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t},set:function(t,r,n){return t[0]=r,t[1]=n,t},add:function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t},subtract:Z,multiply:I,divide:Y,ceil:function(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t},floor:function(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t},min:function(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t},max:function(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t},round:function(t,r){return t[0]=T(r[0]),t[1]=T(r[1]),t},scale:function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t},scaleAndAdd:function(t,r,n,s){return t[0]=r[0]+n[0]*s,t[1]=r[1]+n[1]*s,t},distance:X,squaredDistance:C,length:v,squaredLength:W,negate:function(t,r){return t[0]=-r[0],t[1]=-r[1],t},inverse:function(t,r){return t[0]=1/r[0],t[1]=1/r[1],t},normalize:function(t,r){const n=r[0],s=r[1];let e=n*n+s*s;return e>0&&(e=1/Math.sqrt(e)),t[0]=r[0]*e,t[1]=r[1]*e,t},dot:function(t,r){return t[0]*r[0]+t[1]*r[1]},cross:function(t,r,n){const s=r[0]*n[1]-r[1]*n[0];return t[0]=t[1]=0,t[2]=s,t},lerp:function(t,r,n,s){const e=r[0],i=r[1];return t[0]=e+s*(n[0]-e),t[1]=i+s*(n[1]-i),t},random:function(t,r){r=void 0===r?1:r;const n=2*A()*Math.PI;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t},transformMat2:$,transformMat2d:z,transformMat3:j,transformMat4:_,rotate:function(t,r,n,s){const e=r[0]-n[0],i=r[1]-n[1],h=Math.sin(s),a=Math.cos(s);return t[0]=e*a-i*h+n[0],t[1]=e*h+i*a+n[1],t},angle:function(t,r){const n=t[0],s=t[1],e=r[0],i=r[1],h=Math.sqrt((n*n+s*s)*(e*e+i*i)),a=h&&(n*e+s*i)/h;return Math.acos(Math.min(Math.max(a,-1),1))},zero:function(t){return t[0]=0,t[1]=0,t},str:function(t){return`vec2(${t[0]}, ${t[1]})`},exactEquals:function(t,r){return t[0]===r[0]&&t[1]===r[1]},equals:function(t,r){const n=t[0],s=t[1],e=r[0],i=r[1];return Math.abs(n-e)<=q*Math.max(1,Math.abs(n),Math.abs(e))&&Math.abs(s-i)<=q*Math.max(1,Math.abs(s),Math.abs(i))},len:V,sub:F,mul:D,div:K,dist:B,sqrDist:Q,sqrLen:U,forEach:J});function H(t,r,n){const s=r[0],e=r[1],i=n[3]*s+n[7]*e||1;return t[0]=(n[0]*s+n[4]*e)/i,t[1]=(n[1]*s+n[5]*e)/i,t}function tt(t,r,n){const s=r[0],e=r[1],i=r[2],h=n[3]*s+n[7]*e+n[11]*i||1;return t[0]=(n[0]*s+n[4]*e+n[8]*i)/h,t[1]=(n[1]*s+n[5]*e+n[9]*i)/h,t[2]=(n[2]*s+n[6]*e+n[10]*i)/h,t}function rt(t,r,n){const s=r[0],e=r[1],i=r[2];return t[0]=n[0]*s+n[3]*e+n[6]*i,t[1]=n[1]*s+n[4]*e+n[7]*i,t[2]=n[2]*s+n[5]*e+n[8]*i,t[3]=r[3],t}class nt extends R{constructor(t=0,r=0){super(2),i(t)&&1===arguments.length?this.copy(t):(n.debug&&(L(t),L(r)),this[0]=t,this[1]=r)}set(t,r){return this[0]=t,this[1]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return n.debug&&(L(t.x),L(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return _(this,this,t),this.check()}transformAsVector(t){return H(this,this,t),this.check()}transformByMatrix3(t){return j(this,this,t),this.check()}transformByMatrix2x3(t){return z(this,this,t),this.check()}transformByMatrix2(t){return $(this,this,t),this.check()}}function st(){const t=new N(3);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function et(t){const r=t[0],n=t[1],s=t[2];return Math.sqrt(r*r+n*n+s*s)}function it(t,r,n){const s=new N(3);return s[0]=t,s[1]=r,s[2]=n,s}function ht(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t}function at(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t[2]=r[2]*n[2],t}function ot(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t[2]=r[2]/n[2],t}function ut(t,r){const n=r[0]-t[0],s=r[1]-t[1],e=r[2]-t[2];return Math.sqrt(n*n+s*s+e*e)}function ct(t,r){const n=r[0]-t[0],s=r[1]-t[1],e=r[2]-t[2];return n*n+s*s+e*e}function lt(t){const r=t[0],n=t[1],s=t[2];return r*r+n*n+s*s}function ft(t,r){const n=r[0],s=r[1],e=r[2];let i=n*n+s*s+e*e;return i>0&&(i=1/Math.sqrt(i)),t[0]=r[0]*i,t[1]=r[1]*i,t[2]=r[2]*i,t}function Mt(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]}function mt(t,r,n){const s=r[0],e=r[1],i=r[2],h=n[0],a=n[1],o=n[2];return t[0]=e*o-i*a,t[1]=i*h-s*o,t[2]=s*a-e*h,t}function gt(t,r,n){const s=r[0],e=r[1],i=r[2];let h=n[3]*s+n[7]*e+n[11]*i+n[15];return h=h||1,t[0]=(n[0]*s+n[4]*e+n[8]*i+n[12])/h,t[1]=(n[1]*s+n[5]*e+n[9]*i+n[13])/h,t[2]=(n[2]*s+n[6]*e+n[10]*i+n[14])/h,t}function bt(t,r,n){const s=r[0],e=r[1],i=r[2];return t[0]=s*n[0]+e*n[3]+i*n[6],t[1]=s*n[1]+e*n[4]+i*n[7],t[2]=s*n[2]+e*n[5]+i*n[8],t}function dt(t,r,n){const s=n[0],e=n[1],i=n[2],h=n[3],a=r[0],o=r[1],u=r[2];let c=e*u-i*o,l=i*a-s*u,f=s*o-e*a,M=e*f-i*l,m=i*c-s*f,g=s*l-e*c;const b=2*h;return c*=b,l*=b,f*=b,M*=2,m*=2,g*=2,t[0]=a+c+M,t[1]=o+l+m,t[2]=u+f+g,t}function pt(t,r,n,s){const e=[],i=[];return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],i[0]=e[0],i[1]=e[1]*Math.cos(s)-e[2]*Math.sin(s),i[2]=e[1]*Math.sin(s)+e[2]*Math.cos(s),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Et(t,r,n,s){const e=[],i=[];return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],i[0]=e[2]*Math.sin(s)+e[0]*Math.cos(s),i[1]=e[1],i[2]=e[2]*Math.cos(s)-e[0]*Math.sin(s),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Ot(t,r,n,s){const e=[],i=[];return e[0]=r[0]-n[0],e[1]=r[1]-n[1],e[2]=r[2]-n[2],i[0]=e[0]*Math.cos(s)-e[1]*Math.sin(s),i[1]=e[0]*Math.sin(s)+e[1]*Math.cos(s),i[2]=e[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function yt(t,r){const n=t[0],s=t[1],e=t[2],i=r[0],h=r[1],a=r[2],o=Math.sqrt((n*n+s*s+e*e)*(i*i+h*h+a*a)),u=o&&Mt(t,r)/o;return Math.acos(Math.min(Math.max(u,-1),1))}const xt=ht,kt=at,Lt=ot,St=ut,wt=ct,Rt=et,qt=lt,Nt=function(){const t=st();return function(r,n,s,e,i,h){let a,o;for(n||(n=3),s||(s=0),o=e?Math.min(e*n+s,r.length):r.length,a=s;a<o;a+=n)t[0]=r[a],t[1]=r[a+1],t[2]=r[a+2],i(t,t,h),r[a]=t[0],r[a+1]=t[1],r[a+2]=t[2];return r}}();var At=Object.freeze({__proto__:null,create:st,clone:function(t){const r=new N(3);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r},length:et,fromValues:it,copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t},set:function(t,r,n,s){return t[0]=r,t[1]=n,t[2]=s,t},add:function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t},subtract:ht,multiply:at,divide:ot,ceil:function(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t},floor:function(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t},min:function(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t[2]=Math.min(r[2],n[2]),t},max:function(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t[2]=Math.max(r[2],n[2]),t},round:function(t,r){return t[0]=T(r[0]),t[1]=T(r[1]),t[2]=T(r[2]),t},scale:function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t},scaleAndAdd:function(t,r,n,s){return t[0]=r[0]+n[0]*s,t[1]=r[1]+n[1]*s,t[2]=r[2]+n[2]*s,t},distance:ut,squaredDistance:ct,squaredLength:lt,negate:function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t},inverse:function(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t},normalize:ft,dot:Mt,cross:mt,lerp:function(t,r,n,s){const e=r[0],i=r[1],h=r[2];return t[0]=e+s*(n[0]-e),t[1]=i+s*(n[1]-i),t[2]=h+s*(n[2]-h),t},slerp:function(t,r,n,s){const e=Math.acos(Math.min(Math.max(Mt(r,n),-1),1)),i=Math.sin(e),h=Math.sin((1-s)*e)/i,a=Math.sin(s*e)/i;return t[0]=h*r[0]+a*n[0],t[1]=h*r[1]+a*n[1],t[2]=h*r[2]+a*n[2],t},hermite:function(t,r,n,s,e,i){const h=i*i,a=h*(2*i-3)+1,o=h*(i-2)+i,u=h*(i-1),c=h*(3-2*i);return t[0]=r[0]*a+n[0]*o+s[0]*u+e[0]*c,t[1]=r[1]*a+n[1]*o+s[1]*u+e[1]*c,t[2]=r[2]*a+n[2]*o+s[2]*u+e[2]*c,t},bezier:function(t,r,n,s,e,i){const h=1-i,a=h*h,o=i*i,u=a*h,c=3*i*a,l=3*o*h,f=o*i;return t[0]=r[0]*u+n[0]*c+s[0]*l+e[0]*f,t[1]=r[1]*u+n[1]*c+s[1]*l+e[1]*f,t[2]=r[2]*u+n[2]*c+s[2]*l+e[2]*f,t},random:function(t,r){r=void 0===r?1:r;const n=2*A()*Math.PI,s=2*A()-1,e=Math.sqrt(1-s*s)*r;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t[2]=s*r,t},transformMat4:gt,transformMat3:bt,transformQuat:dt,rotateX:pt,rotateY:Et,rotateZ:Ot,angle:yt,zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t},str:function(t){return`vec3(${t[0]}, ${t[1]}, ${t[2]})`},exactEquals:function(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]},equals:function(t,r){const n=t[0],s=t[1],e=t[2],i=r[0],h=r[1],a=r[2];return Math.abs(n-i)<=q*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(s-h)<=q*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(e-a)<=q*Math.max(1,Math.abs(e),Math.abs(a))},sub:xt,mul:kt,div:Lt,dist:St,sqrDist:wt,len:Rt,sqrLen:qt,forEach:Nt});const Tt=[0,0,0];let Pt,Zt;class It extends R{static get ZERO(){return Pt||(Pt=new It(0,0,0),Object.freeze(Pt)),Pt}constructor(t=0,r=0,s=0){super(-0,-0,-0),1===arguments.length&&i(t)?this.copy(t):(n.debug&&(L(t),L(r),L(s)),this[0]=t,this[1]=r,this[2]=s)}set(t,r,n){return this[0]=t,this[1]=r,this[2]=n,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return n.debug&&(L(t.x),L(t.y),L(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=L(t)}angle(t){return yt(this,t)}cross(t){return mt(this,this,t),this.check()}rotateX({radians:t,origin:r=Tt}){return pt(this,this,r,t),this.check()}rotateY({radians:t,origin:r=Tt}){return Et(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=Tt}){return Ot(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return gt(this,this,t),this.check()}transformAsVector(t){return tt(this,this,t),this.check()}transformByMatrix3(t){return bt(this,this,t),this.check()}transformByMatrix2(t){return function(t,r,n){const s=r[0],e=r[1];t[0]=n[0]*s+n[2]*e,t[1]=n[1]*s+n[3]*e,t[2]=r[2]}(this,this,t),this.check()}transformByQuaternion(t){return dt(this,this,t),this.check()}}class Yt extends R{static get ZERO(){return Zt||(Zt=new Yt(0,0,0,0),Object.freeze(Zt)),Zt}constructor(t=0,r=0,s=0,e=0){super(-0,-0,-0,-0),i(t)&&1===arguments.length?this.copy(t):(n.debug&&(L(t),L(r),L(s),L(e)),this[0]=t,this[1]=r,this[2]=s,this[3]=e)}set(t,r,n,s){return this[0]=t,this[1]=r,this[2]=n,this[3]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return n.debug&&(L(t.x),L(t.y),L(t.z),L(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=L(t)}get w(){return this[3]}set w(t){this[3]=L(t)}transform(t){return gt(this,this,t),this.check()}transformByMatrix3(t){return rt(this,this,t),this.check()}transformByMatrix2(t){return function(t,r,n){const s=r[0],e=r[1];t[0]=n[0]*s+n[2]*e,t[1]=n[1]*s+n[3]*e,t[2]=r[2],t[3]=r[3]}(this,this,t),this.check()}transformByQuaternion(t){return dt(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class Xt extends k{toString(){let t="[";if(n.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let n=0;n<this.RANK;++n)t+=` ${this[n*this.RANK+r]}`}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=` ${this[r]}`}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,n){return this[r*this.RANK+t]=L(n),this}getColumn(t,r=new Array(this.RANK).fill(-0)){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)r[t]=this[n+t];return r}setColumn(t,r){const n=t*this.RANK;for(let t=0;t<this.RANK;++t)this[n+t]=r[t];return this}}function Ct(){const t=new N(9);return N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function vt(t,r){if(t===r){const n=r[1],s=r[2],e=r[5];t[1]=r[3],t[2]=r[6],t[3]=n,t[5]=r[7],t[6]=s,t[7]=e}else t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8];return t}function Wt(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=r[4],a=r[5],o=r[6],u=r[7],c=r[8],l=c*h-a*u,f=-c*i+a*o,M=u*i-h*o;let m=n*l+s*f+e*M;return m?(m=1/m,t[0]=l*m,t[1]=(-c*s+e*u)*m,t[2]=(a*s-e*h)*m,t[3]=f*m,t[4]=(c*n-e*o)*m,t[5]=(-a*n+e*i)*m,t[6]=M*m,t[7]=(-u*n+s*o)*m,t[8]=(h*n-s*i)*m,t):null}function $t(t){const r=t[0],n=t[1],s=t[2],e=t[3],i=t[4],h=t[5],a=t[6],o=t[7],u=t[8];return r*(u*i-h*o)+n*(-u*e+h*a)+s*(o*e-i*a)}function zt(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3],a=r[4],o=r[5],u=r[6],c=r[7],l=r[8],f=n[0],M=n[1],m=n[2],g=n[3],b=n[4],d=n[5],p=n[6],E=n[7],O=n[8];return t[0]=f*s+M*h+m*u,t[1]=f*e+M*a+m*c,t[2]=f*i+M*o+m*l,t[3]=g*s+b*h+d*u,t[4]=g*e+b*a+d*c,t[5]=g*i+b*o+d*l,t[6]=p*s+E*h+O*u,t[7]=p*e+E*a+O*c,t[8]=p*i+E*o+O*l,t}function jt(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3],a=r[4],o=r[5],u=r[6],c=r[7],l=r[8],f=n[0],M=n[1];return t[0]=s,t[1]=e,t[2]=i,t[3]=h,t[4]=a,t[5]=o,t[6]=f*s+M*h+u,t[7]=f*e+M*a+c,t[8]=f*i+M*o+l,t}function _t(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3],a=r[4],o=r[5],u=r[6],c=r[7],l=r[8],f=Math.sin(n),M=Math.cos(n);return t[0]=M*s+f*h,t[1]=M*e+f*a,t[2]=M*i+f*o,t[3]=M*h-f*s,t[4]=M*a-f*e,t[5]=M*o-f*i,t[6]=u,t[7]=c,t[8]=l,t}function Vt(t,r,n){const s=n[0],e=n[1];return t[0]=s*r[0],t[1]=s*r[1],t[2]=s*r[2],t[3]=e*r[3],t[4]=e*r[4],t[5]=e*r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t}function Ft(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=n+n,a=s+s,o=e+e,u=n*h,c=s*h,l=s*a,f=e*h,M=e*a,m=e*o,g=i*h,b=i*a,d=i*o;return t[0]=1-l-m,t[3]=c-d,t[6]=f+b,t[1]=c+d,t[4]=1-u-m,t[7]=M-g,t[2]=f-b,t[5]=M+g,t[8]=1-u-l,t}function Dt(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t}const Kt=zt,Bt=Dt;var Qt,Ut=Object.freeze({__proto__:null,create:Ct,fromMat4:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[4],t[4]=r[5],t[5]=r[6],t[6]=r[8],t[7]=r[9],t[8]=r[10],t},clone:function(t){const r=new N(9);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t},fromValues:function(t,r,n,s,e,i,h,a,o){const u=new N(9);return u[0]=t,u[1]=r,u[2]=n,u[3]=s,u[4]=e,u[5]=i,u[6]=h,u[7]=a,u[8]=o,u},set:function(t,r,n,s,e,i,h,a,o,u){return t[0]=r,t[1]=n,t[2]=s,t[3]=e,t[4]=i,t[5]=h,t[6]=a,t[7]=o,t[8]=u,t},identity:function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},transpose:vt,invert:Wt,adjoint:function(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=r[4],a=r[5],o=r[6],u=r[7],c=r[8];return t[0]=h*c-a*u,t[1]=e*u-s*c,t[2]=s*a-e*h,t[3]=a*o-i*c,t[4]=n*c-e*o,t[5]=e*i-n*a,t[6]=i*u-h*o,t[7]=s*o-n*u,t[8]=n*h-s*i,t},determinant:$t,multiply:zt,translate:jt,rotate:_t,scale:Vt,fromTranslation:function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=r[0],t[7]=r[1],t[8]=1,t},fromRotation:function(t,r){const n=Math.sin(r),s=Math.cos(r);return t[0]=s,t[1]=n,t[2]=0,t[3]=-n,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=r[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=0,t[3]=r[2],t[4]=r[3],t[5]=0,t[6]=r[4],t[7]=r[5],t[8]=1,t},fromQuat:Ft,normalFromMat4:function(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=r[4],a=r[5],o=r[6],u=r[7],c=r[8],l=r[9],f=r[10],M=r[11],m=r[12],g=r[13],b=r[14],d=r[15],p=n*a-s*h,E=n*o-e*h,O=n*u-i*h,y=s*o-e*a,x=s*u-i*a,k=e*u-i*o,L=c*g-l*m,S=c*b-f*m,w=c*d-M*m,R=l*b-f*g,q=l*d-M*g,N=f*d-M*b;let A=p*N-E*q+O*R+y*w-x*S+k*L;return A?(A=1/A,t[0]=(a*N-o*q+u*R)*A,t[1]=(o*w-h*N-u*S)*A,t[2]=(h*q-a*w+u*L)*A,t[3]=(e*q-s*N-i*R)*A,t[4]=(n*N-e*w+i*S)*A,t[5]=(s*w-n*q-i*L)*A,t[6]=(g*k-b*x+d*y)*A,t[7]=(b*O-m*k-d*E)*A,t[8]=(m*x-g*O+d*p)*A,t):null},projection:function(t,r,n){return t[0]=2/r,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return`mat3(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]})`},frob:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8])},add:function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t},subtract:Dt,multiplyScalar:function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t},multiplyScalarAndAdd:function(t,r,n,s){return t[0]=r[0]+n[0]*s,t[1]=r[1]+n[1]*s,t[2]=r[2]+n[2]*s,t[3]=r[3]+n[3]*s,t[4]=r[4]+n[4]*s,t[5]=r[5]+n[5]*s,t[6]=r[6]+n[6]*s,t[7]=r[7]+n[7]*s,t[8]=r[8]+n[8]*s,t},exactEquals:function(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]},equals:function(t,r){const n=t[0],s=t[1],e=t[2],i=t[3],h=t[4],a=t[5],o=t[6],u=t[7],c=t[8],l=r[0],f=r[1],M=r[2],m=r[3],g=r[4],b=r[5],d=r[6],p=r[7],E=r[8];return Math.abs(n-l)<=q*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(s-f)<=q*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(e-M)<=q*Math.max(1,Math.abs(e),Math.abs(M))&&Math.abs(i-m)<=q*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(h-g)<=q*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(a-b)<=q*Math.max(1,Math.abs(a),Math.abs(b))&&Math.abs(o-d)<=q*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(u-p)<=q*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(c-E)<=q*Math.max(1,Math.abs(c),Math.abs(E))},mul:Kt,sub:Bt});!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"}(Qt||(Qt={}));const Jt=Object.freeze([1,0,0,0,1,0,0,0,1]);class Gt extends Xt{static get IDENTITY(){return function(){tr||(tr=new Gt,Object.freeze(tr));return tr}()}static get ZERO(){return function(){Ht||(Ht=new Gt([0,0,0,0,0,0,0,0,0]),Object.freeze(Ht));return Ht}()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return Qt}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(Jt)}fromObject(t){return this.check()}fromQuaternion(t){return Ft(this,t),this.check()}set(t,r,n,s,e,i,h,a,o){return this[0]=t,this[1]=r,this[2]=n,this[3]=s,this[4]=e,this[5]=i,this[6]=h,this[7]=a,this[8]=o,this.check()}setRowMajor(t,r,n,s,e,i,h,a,o){return this[0]=t,this[1]=s,this[2]=h,this[3]=r,this[4]=e,this[5]=a,this[6]=n,this[7]=i,this[8]=o,this.check()}determinant(){return $t(this)}transpose(){return vt(this,this),this.check()}invert(){return Wt(this,this),this.check()}multiplyLeft(t){return zt(this,t,this),this.check()}multiplyRight(t){return zt(this,this,t),this.check()}rotate(t){return _t(this,this,t),this.check()}scale(t){return Array.isArray(t)?Vt(this,this,t):Vt(this,this,[t,t]),this.check()}translate(t){return jt(this,this,t),this.check()}transform(t,r){let n;switch(t.length){case 2:n=j(r||[-0,-0],t,this);break;case 3:n=bt(r||[-0,-0,-0],t,this);break;case 4:n=rt(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return S(n,t.length),n}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}}let Ht,tr=null;function rr(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nr(t,r){if(t===r){const n=r[1],s=r[2],e=r[3],i=r[6],h=r[7],a=r[11];t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=n,t[6]=r[9],t[7]=r[13],t[8]=s,t[9]=i,t[11]=r[14],t[12]=e,t[13]=h,t[14]=a}else t[0]=r[0],t[1]=r[4],t[2]=r[8],t[3]=r[12],t[4]=r[1],t[5]=r[5],t[6]=r[9],t[7]=r[13],t[8]=r[2],t[9]=r[6],t[10]=r[10],t[11]=r[14],t[12]=r[3],t[13]=r[7],t[14]=r[11],t[15]=r[15];return t}function sr(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=r[4],a=r[5],o=r[6],u=r[7],c=r[8],l=r[9],f=r[10],M=r[11],m=r[12],g=r[13],b=r[14],d=r[15],p=n*a-s*h,E=n*o-e*h,O=n*u-i*h,y=s*o-e*a,x=s*u-i*a,k=e*u-i*o,L=c*g-l*m,S=c*b-f*m,w=c*d-M*m,R=l*b-f*g,q=l*d-M*g,N=f*d-M*b;let A=p*N-E*q+O*R+y*w-x*S+k*L;return A?(A=1/A,t[0]=(a*N-o*q+u*R)*A,t[1]=(e*q-s*N-i*R)*A,t[2]=(g*k-b*x+d*y)*A,t[3]=(f*x-l*k-M*y)*A,t[4]=(o*w-h*N-u*S)*A,t[5]=(n*N-e*w+i*S)*A,t[6]=(b*O-m*k-d*E)*A,t[7]=(c*k-f*O+M*E)*A,t[8]=(h*q-a*w+u*L)*A,t[9]=(s*w-n*q-i*L)*A,t[10]=(m*x-g*O+d*p)*A,t[11]=(l*O-c*x-M*p)*A,t[12]=(a*S-h*R-o*L)*A,t[13]=(n*R-s*S+e*L)*A,t[14]=(g*E-m*y-b*p)*A,t[15]=(c*y-l*E+f*p)*A,t):null}function er(t){const r=t[0],n=t[1],s=t[2],e=t[3],i=t[4],h=t[5],a=t[6],o=t[7],u=t[8],c=t[9],l=t[10],f=t[11],M=t[12],m=t[13],g=t[14],b=r*h-n*i,d=r*a-s*i,p=n*a-s*h,E=u*m-c*M,O=u*g-l*M,y=c*g-l*m;return o*(r*y-n*O+s*E)-e*(i*y-h*O+a*E)+t[15]*(u*p-c*d+l*b)-f*(M*p-m*d+g*b)}function ir(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3],a=r[4],o=r[5],u=r[6],c=r[7],l=r[8],f=r[9],M=r[10],m=r[11],g=r[12],b=r[13],d=r[14],p=r[15];let E=n[0],O=n[1],y=n[2],x=n[3];return t[0]=E*s+O*a+y*l+x*g,t[1]=E*e+O*o+y*f+x*b,t[2]=E*i+O*u+y*M+x*d,t[3]=E*h+O*c+y*m+x*p,E=n[4],O=n[5],y=n[6],x=n[7],t[4]=E*s+O*a+y*l+x*g,t[5]=E*e+O*o+y*f+x*b,t[6]=E*i+O*u+y*M+x*d,t[7]=E*h+O*c+y*m+x*p,E=n[8],O=n[9],y=n[10],x=n[11],t[8]=E*s+O*a+y*l+x*g,t[9]=E*e+O*o+y*f+x*b,t[10]=E*i+O*u+y*M+x*d,t[11]=E*h+O*c+y*m+x*p,E=n[12],O=n[13],y=n[14],x=n[15],t[12]=E*s+O*a+y*l+x*g,t[13]=E*e+O*o+y*f+x*b,t[14]=E*i+O*u+y*M+x*d,t[15]=E*h+O*c+y*m+x*p,t}function hr(t,r,n){const s=n[0],e=n[1],i=n[2];let h,a,o,u,c,l,f,M,m,g,b,d;return r===t?(t[12]=r[0]*s+r[4]*e+r[8]*i+r[12],t[13]=r[1]*s+r[5]*e+r[9]*i+r[13],t[14]=r[2]*s+r[6]*e+r[10]*i+r[14],t[15]=r[3]*s+r[7]*e+r[11]*i+r[15]):(h=r[0],a=r[1],o=r[2],u=r[3],c=r[4],l=r[5],f=r[6],M=r[7],m=r[8],g=r[9],b=r[10],d=r[11],t[0]=h,t[1]=a,t[2]=o,t[3]=u,t[4]=c,t[5]=l,t[6]=f,t[7]=M,t[8]=m,t[9]=g,t[10]=b,t[11]=d,t[12]=h*s+c*e+m*i+r[12],t[13]=a*s+l*e+g*i+r[13],t[14]=o*s+f*e+b*i+r[14],t[15]=u*s+M*e+d*i+r[15]),t}function ar(t,r,n){const s=n[0],e=n[1],i=n[2];return t[0]=r[0]*s,t[1]=r[1]*s,t[2]=r[2]*s,t[3]=r[3]*s,t[4]=r[4]*e,t[5]=r[5]*e,t[6]=r[6]*e,t[7]=r[7]*e,t[8]=r[8]*i,t[9]=r[9]*i,t[10]=r[10]*i,t[11]=r[11]*i,t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t}function or(t,r,n,s){let e,i,h,a,o,u,c,l,f,M,m,g,b,d,p,E,O,y,x,k,L,S,w,R,N=s[0],A=s[1],T=s[2],P=Math.sqrt(N*N+A*A+T*T);return P<q?null:(P=1/P,N*=P,A*=P,T*=P,i=Math.sin(n),e=Math.cos(n),h=1-e,a=r[0],o=r[1],u=r[2],c=r[3],l=r[4],f=r[5],M=r[6],m=r[7],g=r[8],b=r[9],d=r[10],p=r[11],E=N*N*h+e,O=A*N*h+T*i,y=T*N*h-A*i,x=N*A*h-T*i,k=A*A*h+e,L=T*A*h+N*i,S=N*T*h+A*i,w=A*T*h-N*i,R=T*T*h+e,t[0]=a*E+l*O+g*y,t[1]=o*E+f*O+b*y,t[2]=u*E+M*O+d*y,t[3]=c*E+m*O+p*y,t[4]=a*x+l*k+g*L,t[5]=o*x+f*k+b*L,t[6]=u*x+M*k+d*L,t[7]=c*x+m*k+p*L,t[8]=a*S+l*w+g*R,t[9]=o*S+f*w+b*R,t[10]=u*S+M*w+d*R,t[11]=c*S+m*w+p*R,r!==t&&(t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t)}function ur(t,r,n){const s=Math.sin(n),e=Math.cos(n),i=r[4],h=r[5],a=r[6],o=r[7],u=r[8],c=r[9],l=r[10],f=r[11];return r!==t&&(t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[4]=i*e+u*s,t[5]=h*e+c*s,t[6]=a*e+l*s,t[7]=o*e+f*s,t[8]=u*e-i*s,t[9]=c*e-h*s,t[10]=l*e-a*s,t[11]=f*e-o*s,t}function cr(t,r,n){const s=Math.sin(n),e=Math.cos(n),i=r[0],h=r[1],a=r[2],o=r[3],u=r[8],c=r[9],l=r[10],f=r[11];return r!==t&&(t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*e-u*s,t[1]=h*e-c*s,t[2]=a*e-l*s,t[3]=o*e-f*s,t[8]=i*s+u*e,t[9]=h*s+c*e,t[10]=a*s+l*e,t[11]=o*s+f*e,t}function lr(t,r,n){const s=Math.sin(n),e=Math.cos(n),i=r[0],h=r[1],a=r[2],o=r[3],u=r[4],c=r[5],l=r[6],f=r[7];return r!==t&&(t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15]),t[0]=i*e+u*s,t[1]=h*e+c*s,t[2]=a*e+l*s,t[3]=o*e+f*s,t[4]=u*e-i*s,t[5]=c*e-h*s,t[6]=l*e-a*s,t[7]=f*e-o*s,t}function fr(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3],a=s+s,o=e+e,u=i+i,c=s*a,l=s*o,f=s*u,M=e*o,m=e*u,g=i*u,b=h*a,d=h*o,p=h*u;return t[0]=1-(M+g),t[1]=l+p,t[2]=f-d,t[3]=0,t[4]=l-p,t[5]=1-(c+g),t[6]=m+b,t[7]=0,t[8]=f+d,t[9]=m-b,t[10]=1-(c+M),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function Mr(t,r){const n=r[0],s=r[1],e=r[2],i=r[4],h=r[5],a=r[6],o=r[8],u=r[9],c=r[10];return t[0]=Math.sqrt(n*n+s*s+e*e),t[1]=Math.sqrt(i*i+h*h+a*a),t[2]=Math.sqrt(o*o+u*u+c*c),t}function mr(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=n+n,a=s+s,o=e+e,u=n*h,c=s*h,l=s*a,f=e*h,M=e*a,m=e*o,g=i*h,b=i*a,d=i*o;return t[0]=1-l-m,t[1]=c+d,t[2]=f-b,t[3]=0,t[4]=c-d,t[5]=1-u-m,t[6]=M+g,t[7]=0,t[8]=f+b,t[9]=M-g,t[10]=1-u-l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gr(t,r,n,s,e,i,h){const a=1/(n-r),o=1/(e-s),u=1/(i-h);return t[0]=2*i*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*o,t[6]=0,t[7]=0,t[8]=(n+r)*a,t[9]=(e+s)*o,t[10]=(h+i)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=h*i*2*u,t[15]=0,t}function br(t,r,n,s,e){const i=1/Math.tan(r/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0){const r=1/(s-e);t[10]=(e+s)*r,t[14]=2*e*s*r}else t[10]=-1,t[14]=-2*s;return t}const dr=br;function pr(t,r,n,s,e,i,h){const a=1/(r-n),o=1/(s-e),u=1/(i-h);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(r+n)*a,t[13]=(e+s)*o,t[14]=(h+i)*u,t[15]=1,t}const Er=pr;function Or(t,r,n,s){let e,i,h,a,o,u,c,l,f,M;const m=r[0],g=r[1],b=r[2],d=s[0],p=s[1],E=s[2],O=n[0],y=n[1],x=n[2];return Math.abs(m-O)<q&&Math.abs(g-y)<q&&Math.abs(b-x)<q?rr(t):(l=m-O,f=g-y,M=b-x,e=1/Math.sqrt(l*l+f*f+M*M),l*=e,f*=e,M*=e,i=p*M-E*f,h=E*l-d*M,a=d*f-p*l,e=Math.sqrt(i*i+h*h+a*a),e?(e=1/e,i*=e,h*=e,a*=e):(i=0,h=0,a=0),o=f*a-M*h,u=M*i-l*a,c=l*h-f*i,e=Math.sqrt(o*o+u*u+c*c),e?(e=1/e,o*=e,u*=e,c*=e):(o=0,u=0,c=0),t[0]=i,t[1]=o,t[2]=l,t[3]=0,t[4]=h,t[5]=u,t[6]=f,t[7]=0,t[8]=a,t[9]=c,t[10]=M,t[11]=0,t[12]=-(i*m+h*g+a*b),t[13]=-(o*m+u*g+c*b),t[14]=-(l*m+f*g+M*b),t[15]=1,t)}function yr(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t[4]=r[4]-n[4],t[5]=r[5]-n[5],t[6]=r[6]-n[6],t[7]=r[7]-n[7],t[8]=r[8]-n[8],t[9]=r[9]-n[9],t[10]=r[10]-n[10],t[11]=r[11]-n[11],t[12]=r[12]-n[12],t[13]=r[13]-n[13],t[14]=r[14]-n[14],t[15]=r[15]-n[15],t}const xr=ir,kr=yr;var Lr=Object.freeze({__proto__:null,create:function(){const t=new N(16);return N!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},clone:function(t){const r=new N(16);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],r},copy:function(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t[4]=r[4],t[5]=r[5],t[6]=r[6],t[7]=r[7],t[8]=r[8],t[9]=r[9],t[10]=r[10],t[11]=r[11],t[12]=r[12],t[13]=r[13],t[14]=r[14],t[15]=r[15],t},fromValues:function(t,r,n,s,e,i,h,a,o,u,c,l,f,M,m,g){const b=new N(16);return b[0]=t,b[1]=r,b[2]=n,b[3]=s,b[4]=e,b[5]=i,b[6]=h,b[7]=a,b[8]=o,b[9]=u,b[10]=c,b[11]=l,b[12]=f,b[13]=M,b[14]=m,b[15]=g,b},set:function(t,r,n,s,e,i,h,a,o,u,c,l,f,M,m,g,b){return t[0]=r,t[1]=n,t[2]=s,t[3]=e,t[4]=i,t[5]=h,t[6]=a,t[7]=o,t[8]=u,t[9]=c,t[10]=l,t[11]=f,t[12]=M,t[13]=m,t[14]=g,t[15]=b,t},identity:rr,transpose:nr,invert:sr,adjoint:function(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=r[4],a=r[5],o=r[6],u=r[7],c=r[8],l=r[9],f=r[10],M=r[11],m=r[12],g=r[13],b=r[14],d=r[15],p=n*a-s*h,E=n*o-e*h,O=n*u-i*h,y=s*o-e*a,x=s*u-i*a,k=e*u-i*o,L=c*g-l*m,S=c*b-f*m,w=c*d-M*m,R=l*b-f*g,q=l*d-M*g,N=f*d-M*b;return t[0]=a*N-o*q+u*R,t[1]=e*q-s*N-i*R,t[2]=g*k-b*x+d*y,t[3]=f*x-l*k-M*y,t[4]=o*w-h*N-u*S,t[5]=n*N-e*w+i*S,t[6]=b*O-m*k-d*E,t[7]=c*k-f*O+M*E,t[8]=h*q-a*w+u*L,t[9]=s*w-n*q-i*L,t[10]=m*x-g*O+d*p,t[11]=l*O-c*x-M*p,t[12]=a*S-h*R-o*L,t[13]=n*R-s*S+e*L,t[14]=g*E-m*y-b*p,t[15]=c*y-l*E+f*p,t},determinant:er,multiply:ir,translate:hr,scale:ar,rotate:or,rotateX:ur,rotateY:cr,rotateZ:lr,fromTranslation:function(t,r){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},fromScaling:function(t,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,r,n){let s,e,i,h=n[0],a=n[1],o=n[2],u=Math.sqrt(h*h+a*a+o*o);return u<q?null:(u=1/u,h*=u,a*=u,o*=u,e=Math.sin(r),s=Math.cos(r),i=1-s,t[0]=h*h*i+s,t[1]=a*h*i+o*e,t[2]=o*h*i-a*e,t[3]=0,t[4]=h*a*i-o*e,t[5]=a*a*i+s,t[6]=o*a*i+h*e,t[7]=0,t[8]=h*o*i+a*e,t[9]=a*o*i-h*e,t[10]=o*o*i+s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:function(t,r){const n=Math.sin(r),s=Math.cos(r);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromYRotation:function(t,r){const n=Math.sin(r),s=Math.cos(r);return t[0]=s,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,r){const n=Math.sin(r),s=Math.cos(r);return t[0]=s,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:fr,fromQuat2:function(t,r){const n=new N(3),s=-r[0],e=-r[1],i=-r[2],h=r[3],a=r[4],o=r[5],u=r[6],c=r[7],l=s*s+e*e+i*i+h*h;return l>0?(n[0]=2*(a*h+c*s+o*i-u*e)/l,n[1]=2*(o*h+c*e+u*s-a*i)/l,n[2]=2*(u*h+c*i+a*e-o*s)/l):(n[0]=2*(a*h+c*s+o*i-u*e),n[1]=2*(o*h+c*e+u*s-a*i),n[2]=2*(u*h+c*i+a*e-o*s)),fr(t,r,n),t},getTranslation:function(t,r){return t[0]=r[12],t[1]=r[13],t[2]=r[14],t},getScaling:Mr,getRotation:function(t,r){const n=new N(3);Mr(n,r);const s=1/n[0],e=1/n[1],i=1/n[2],h=r[0]*s,a=r[1]*e,o=r[2]*i,u=r[4]*s,c=r[5]*e,l=r[6]*i,f=r[8]*s,M=r[9]*e,m=r[10]*i,g=h+c+m;let b=0;return g>0?(b=2*Math.sqrt(g+1),t[3]=.25*b,t[0]=(l-M)/b,t[1]=(f-o)/b,t[2]=(a-u)/b):h>c&&h>m?(b=2*Math.sqrt(1+h-c-m),t[3]=(l-M)/b,t[0]=.25*b,t[1]=(a+u)/b,t[2]=(f+o)/b):c>m?(b=2*Math.sqrt(1+c-h-m),t[3]=(f-o)/b,t[0]=(a+u)/b,t[1]=.25*b,t[2]=(l+M)/b):(b=2*Math.sqrt(1+m-h-c),t[3]=(a-u)/b,t[0]=(f+o)/b,t[1]=(l+M)/b,t[2]=.25*b),t},decompose:function(t,r,n,s){r[0]=s[12],r[1]=s[13],r[2]=s[14];const e=s[0],i=s[1],h=s[2],a=s[4],o=s[5],u=s[6],c=s[8],l=s[9],f=s[10];n[0]=Math.sqrt(e*e+i*i+h*h),n[1]=Math.sqrt(a*a+o*o+u*u),n[2]=Math.sqrt(c*c+l*l+f*f);const M=1/n[0],m=1/n[1],g=1/n[2],b=e*M,d=i*m,p=h*g,E=a*M,O=o*m,y=u*g,x=c*M,k=l*m,L=f*g,S=b+O+L;let w=0;return S>0?(w=2*Math.sqrt(S+1),t[3]=.25*w,t[0]=(y-k)/w,t[1]=(x-p)/w,t[2]=(d-E)/w):b>O&&b>L?(w=2*Math.sqrt(1+b-O-L),t[3]=(y-k)/w,t[0]=.25*w,t[1]=(d+E)/w,t[2]=(x+p)/w):O>L?(w=2*Math.sqrt(1+O-b-L),t[3]=(x-p)/w,t[0]=(d+E)/w,t[1]=.25*w,t[2]=(y+k)/w):(w=2*Math.sqrt(1+L-b-O),t[3]=(d-E)/w,t[0]=(x+p)/w,t[1]=(y+k)/w,t[2]=.25*w),t},fromRotationTranslationScale:function(t,r,n,s){const e=r[0],i=r[1],h=r[2],a=r[3],o=e+e,u=i+i,c=h+h,l=e*o,f=e*u,M=e*c,m=i*u,g=i*c,b=h*c,d=a*o,p=a*u,E=a*c,O=s[0],y=s[1],x=s[2];return t[0]=(1-(m+b))*O,t[1]=(f+E)*O,t[2]=(M-p)*O,t[3]=0,t[4]=(f-E)*y,t[5]=(1-(l+b))*y,t[6]=(g+d)*y,t[7]=0,t[8]=(M+p)*x,t[9]=(g-d)*x,t[10]=(1-(l+m))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,r,n,s,e){const i=r[0],h=r[1],a=r[2],o=r[3],u=i+i,c=h+h,l=a+a,f=i*u,M=i*c,m=i*l,g=h*c,b=h*l,d=a*l,p=o*u,E=o*c,O=o*l,y=s[0],x=s[1],k=s[2],L=e[0],S=e[1],w=e[2],R=(1-(g+d))*y,q=(M+O)*y,N=(m-E)*y,A=(M-O)*x,T=(1-(f+d))*x,P=(b+p)*x,Z=(m+E)*k,I=(b-p)*k,Y=(1-(f+g))*k;return t[0]=R,t[1]=q,t[2]=N,t[3]=0,t[4]=A,t[5]=T,t[6]=P,t[7]=0,t[8]=Z,t[9]=I,t[10]=Y,t[11]=0,t[12]=n[0]+L-(R*L+A*S+Z*w),t[13]=n[1]+S-(q*L+T*S+I*w),t[14]=n[2]+w-(N*L+P*S+Y*w),t[15]=1,t},fromQuat:mr,frustum:gr,perspectiveNO:br,perspective:dr,perspectiveZO:function(t,r,n,s,e){const i=1/Math.tan(r/2);if(t[0]=i/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=e&&e!==1/0){const r=1/(s-e);t[10]=e*r,t[14]=e*s*r}else t[10]=-1,t[14]=-s;return t},perspectiveFromFieldOfView:function(t,r,n,s){const e=Math.tan(r.upDegrees*Math.PI/180),i=Math.tan(r.downDegrees*Math.PI/180),h=Math.tan(r.leftDegrees*Math.PI/180),a=Math.tan(r.rightDegrees*Math.PI/180),o=2/(h+a),u=2/(e+i);return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(h-a)*o*.5,t[9]=(e-i)*u*.5,t[10]=s/(n-s),t[11]=-1,t[12]=0,t[13]=0,t[14]=s*n/(n-s),t[15]=0,t},orthoNO:pr,ortho:Er,orthoZO:function(t,r,n,s,e,i,h){const a=1/(r-n),o=1/(s-e),u=1/(i-h);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(r+n)*a,t[13]=(e+s)*o,t[14]=i*u,t[15]=1,t},lookAt:Or,targetTo:function(t,r,n,s){const e=r[0],i=r[1],h=r[2],a=s[0],o=s[1],u=s[2];let c=e-n[0],l=i-n[1],f=h-n[2],M=c*c+l*l+f*f;M>0&&(M=1/Math.sqrt(M),c*=M,l*=M,f*=M);let m=o*f-u*l,g=u*c-a*f,b=a*l-o*c;return M=m*m+g*g+b*b,M>0&&(M=1/Math.sqrt(M),m*=M,g*=M,b*=M),t[0]=m,t[1]=g,t[2]=b,t[3]=0,t[4]=l*b-f*g,t[5]=f*m-c*b,t[6]=c*g-l*m,t[7]=0,t[8]=c,t[9]=l,t[10]=f,t[11]=0,t[12]=e,t[13]=i,t[14]=h,t[15]=1,t},str:function(t){return`mat4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}, ${t[4]}, ${t[5]}, ${t[6]}, ${t[7]}, ${t[8]}, ${t[9]}, ${t[10]}, ${t[11]}, ${t[12]}, ${t[13]}, ${t[14]}, ${t[15]})`},frob:function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]+t[3]*t[3]+t[4]*t[4]+t[5]*t[5]+t[6]*t[6]+t[7]*t[7]+t[8]*t[8]+t[9]*t[9]+t[10]*t[10]+t[11]*t[11]+t[12]*t[12]+t[13]*t[13]+t[14]*t[14]+t[15]*t[15])},add:function(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t[4]=r[4]+n[4],t[5]=r[5]+n[5],t[6]=r[6]+n[6],t[7]=r[7]+n[7],t[8]=r[8]+n[8],t[9]=r[9]+n[9],t[10]=r[10]+n[10],t[11]=r[11]+n[11],t[12]=r[12]+n[12],t[13]=r[13]+n[13],t[14]=r[14]+n[14],t[15]=r[15]+n[15],t},subtract:yr,multiplyScalar:function(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t[4]=r[4]*n,t[5]=r[5]*n,t[6]=r[6]*n,t[7]=r[7]*n,t[8]=r[8]*n,t[9]=r[9]*n,t[10]=r[10]*n,t[11]=r[11]*n,t[12]=r[12]*n,t[13]=r[13]*n,t[14]=r[14]*n,t[15]=r[15]*n,t},multiplyScalarAndAdd:function(t,r,n,s){return t[0]=r[0]+n[0]*s,t[1]=r[1]+n[1]*s,t[2]=r[2]+n[2]*s,t[3]=r[3]+n[3]*s,t[4]=r[4]+n[4]*s,t[5]=r[5]+n[5]*s,t[6]=r[6]+n[6]*s,t[7]=r[7]+n[7]*s,t[8]=r[8]+n[8]*s,t[9]=r[9]+n[9]*s,t[10]=r[10]+n[10]*s,t[11]=r[11]+n[11]*s,t[12]=r[12]+n[12]*s,t[13]=r[13]+n[13]*s,t[14]=r[14]+n[14]*s,t[15]=r[15]+n[15]*s,t},exactEquals:function(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]&&t[4]===r[4]&&t[5]===r[5]&&t[6]===r[6]&&t[7]===r[7]&&t[8]===r[8]&&t[9]===r[9]&&t[10]===r[10]&&t[11]===r[11]&&t[12]===r[12]&&t[13]===r[13]&&t[14]===r[14]&&t[15]===r[15]},equals:function(t,r){const n=t[0],s=t[1],e=t[2],i=t[3],h=t[4],a=t[5],o=t[6],u=t[7],c=t[8],l=t[9],f=t[10],M=t[11],m=t[12],g=t[13],b=t[14],d=t[15],p=r[0],E=r[1],O=r[2],y=r[3],x=r[4],k=r[5],L=r[6],S=r[7],w=r[8],R=r[9],N=r[10],A=r[11],T=r[12],P=r[13],Z=r[14],I=r[15];return Math.abs(n-p)<=q*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(s-E)<=q*Math.max(1,Math.abs(s),Math.abs(E))&&Math.abs(e-O)<=q*Math.max(1,Math.abs(e),Math.abs(O))&&Math.abs(i-y)<=q*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(h-x)<=q*Math.max(1,Math.abs(h),Math.abs(x))&&Math.abs(a-k)<=q*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(o-L)<=q*Math.max(1,Math.abs(o),Math.abs(L))&&Math.abs(u-S)<=q*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(c-w)<=q*Math.max(1,Math.abs(c),Math.abs(w))&&Math.abs(l-R)<=q*Math.max(1,Math.abs(l),Math.abs(R))&&Math.abs(f-N)<=q*Math.max(1,Math.abs(f),Math.abs(N))&&Math.abs(M-A)<=q*Math.max(1,Math.abs(M),Math.abs(A))&&Math.abs(m-T)<=q*Math.max(1,Math.abs(m),Math.abs(T))&&Math.abs(g-P)<=q*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(b-Z)<=q*Math.max(1,Math.abs(b),Math.abs(Z))&&Math.abs(d-I)<=q*Math.max(1,Math.abs(d),Math.abs(I))},mul:xr,sub:kr});function Sr(){const t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function wr(t){const r=new N(4);return r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r}function Rr(t,r,n,s){const e=new N(4);return e[0]=t,e[1]=r,e[2]=n,e[3]=s,e}function qr(t,r){return t[0]=r[0],t[1]=r[1],t[2]=r[2],t[3]=r[3],t}function Nr(t,r,n,s,e){return t[0]=r,t[1]=n,t[2]=s,t[3]=e,t}function Ar(t,r,n){return t[0]=r[0]+n[0],t[1]=r[1]+n[1],t[2]=r[2]+n[2],t[3]=r[3]+n[3],t}function Tr(t,r,n){return t[0]=r[0]-n[0],t[1]=r[1]-n[1],t[2]=r[2]-n[2],t[3]=r[3]-n[3],t}function Pr(t,r,n){return t[0]=r[0]*n[0],t[1]=r[1]*n[1],t[2]=r[2]*n[2],t[3]=r[3]*n[3],t}function Zr(t,r,n){return t[0]=r[0]/n[0],t[1]=r[1]/n[1],t[2]=r[2]/n[2],t[3]=r[3]/n[3],t}function Ir(t,r,n){return t[0]=r[0]*n,t[1]=r[1]*n,t[2]=r[2]*n,t[3]=r[3]*n,t}function Yr(t,r){const n=r[0]-t[0],s=r[1]-t[1],e=r[2]-t[2],i=r[3]-t[3];return Math.sqrt(n*n+s*s+e*e+i*i)}function Xr(t,r){const n=r[0]-t[0],s=r[1]-t[1],e=r[2]-t[2],i=r[3]-t[3];return n*n+s*s+e*e+i*i}function Cr(t){const r=t[0],n=t[1],s=t[2],e=t[3];return Math.sqrt(r*r+n*n+s*s+e*e)}function vr(t){const r=t[0],n=t[1],s=t[2],e=t[3];return r*r+n*n+s*s+e*e}function Wr(t,r){const n=r[0],s=r[1],e=r[2],i=r[3];let h=n*n+s*s+e*e+i*i;return h>0&&(h=1/Math.sqrt(h)),t[0]=n*h,t[1]=s*h,t[2]=e*h,t[3]=i*h,t}function $r(t,r){return t[0]*r[0]+t[1]*r[1]+t[2]*r[2]+t[3]*r[3]}function zr(t,r,n,s){const e=r[0],i=r[1],h=r[2],a=r[3];return t[0]=e+s*(n[0]-e),t[1]=i+s*(n[1]-i),t[2]=h+s*(n[2]-h),t[3]=a+s*(n[3]-a),t}function jr(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3];return t[0]=n[0]*s+n[4]*e+n[8]*i+n[12]*h,t[1]=n[1]*s+n[5]*e+n[9]*i+n[13]*h,t[2]=n[2]*s+n[6]*e+n[10]*i+n[14]*h,t[3]=n[3]*s+n[7]*e+n[11]*i+n[15]*h,t}function _r(t,r,n){const s=r[0],e=r[1],i=r[2],h=n[0],a=n[1],o=n[2],u=n[3],c=u*s+a*i-o*e,l=u*e+o*s-h*i,f=u*i+h*e-a*s,M=-h*s-a*e-o*i;return t[0]=c*u+M*-h+l*-o-f*-a,t[1]=l*u+M*-a+f*-h-c*-o,t[2]=f*u+M*-o+c*-a-l*-h,t[3]=r[3],t}function Vr(t,r){return t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2]&&t[3]===r[3]}const Fr=Tr,Dr=Pr,Kr=Zr,Br=Yr,Qr=Xr,Ur=Cr,Jr=vr,Gr=function(){const t=Sr();return function(r,n,s,e,i,h){let a,o;for(n||(n=4),s||(s=0),o=e?Math.min(e*n+s,r.length):r.length,a=s;a<o;a+=n)t[0]=r[a],t[1]=r[a+1],t[2]=r[a+2],t[3]=r[a+3],i(t,t,h),r[a]=t[0],r[a+1]=t[1],r[a+2]=t[2],r[a+3]=t[3];return r}}();var Hr,tn=Object.freeze({__proto__:null,create:Sr,clone:wr,fromValues:Rr,copy:qr,set:Nr,add:Ar,subtract:Tr,multiply:Pr,divide:Zr,ceil:function(t,r){return t[0]=Math.ceil(r[0]),t[1]=Math.ceil(r[1]),t[2]=Math.ceil(r[2]),t[3]=Math.ceil(r[3]),t},floor:function(t,r){return t[0]=Math.floor(r[0]),t[1]=Math.floor(r[1]),t[2]=Math.floor(r[2]),t[3]=Math.floor(r[3]),t},min:function(t,r,n){return t[0]=Math.min(r[0],n[0]),t[1]=Math.min(r[1],n[1]),t[2]=Math.min(r[2],n[2]),t[3]=Math.min(r[3],n[3]),t},max:function(t,r,n){return t[0]=Math.max(r[0],n[0]),t[1]=Math.max(r[1],n[1]),t[2]=Math.max(r[2],n[2]),t[3]=Math.max(r[3],n[3]),t},round:function(t,r){return t[0]=T(r[0]),t[1]=T(r[1]),t[2]=T(r[2]),t[3]=T(r[3]),t},scale:Ir,scaleAndAdd:function(t,r,n,s){return t[0]=r[0]+n[0]*s,t[1]=r[1]+n[1]*s,t[2]=r[2]+n[2]*s,t[3]=r[3]+n[3]*s,t},distance:Yr,squaredDistance:Xr,length:Cr,squaredLength:vr,negate:function(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=-r[3],t},inverse:function(t,r){return t[0]=1/r[0],t[1]=1/r[1],t[2]=1/r[2],t[3]=1/r[3],t},normalize:Wr,dot:$r,cross:function(t,r,n,s){const e=n[0]*s[1]-n[1]*s[0],i=n[0]*s[2]-n[2]*s[0],h=n[0]*s[3]-n[3]*s[0],a=n[1]*s[2]-n[2]*s[1],o=n[1]*s[3]-n[3]*s[1],u=n[2]*s[3]-n[3]*s[2],c=r[0],l=r[1],f=r[2],M=r[3];return t[0]=l*u-f*o+M*a,t[1]=-c*u+f*h-M*i,t[2]=c*o-l*h+M*e,t[3]=-c*a+l*i-f*e,t},lerp:zr,random:function(t,r){let n,s,e,i,h,a;r=void 0===r?1:r;do{n=2*A()-1,s=2*A()-1,h=n*n+s*s}while(h>=1);do{e=2*A()-1,i=2*A()-1,a=e*e+i*i}while(a>=1);const o=Math.sqrt((1-h)/a);return t[0]=r*n,t[1]=r*s,t[2]=r*e*o,t[3]=r*i*o,t},transformMat4:jr,transformQuat:_r,zero:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},str:function(t){return`vec4(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`},exactEquals:Vr,equals:function(t,r){const n=t[0],s=t[1],e=t[2],i=t[3],h=r[0],a=r[1],o=r[2],u=r[3];return Math.abs(n-h)<=q*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(s-a)<=q*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(e-o)<=q*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(i-u)<=q*Math.max(1,Math.abs(i),Math.abs(u))},sub:Fr,mul:Dr,div:Kr,dist:Br,sqrDist:Qr,len:Ur,sqrLen:Jr,forEach:Gr});!function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"}(Hr||(Hr={}));const rn=45*Math.PI/180,nn=1,sn=.1,en=500,hn=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class an extends Xt{static get IDENTITY(){return function(){un||(un=new an,Object.freeze(un));return un}()}static get ZERO(){return function(){on||(on=new an([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(on));return on}()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Hr}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),1===arguments.length&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,n,s,e,i,h,a,o,u,c,l,f,M,m,g){return this[0]=t,this[1]=r,this[2]=n,this[3]=s,this[4]=e,this[5]=i,this[6]=h,this[7]=a,this[8]=o,this[9]=u,this[10]=c,this[11]=l,this[12]=f,this[13]=M,this[14]=m,this[15]=g,this.check()}setRowMajor(t,r,n,s,e,i,h,a,o,u,c,l,f,M,m,g){return this[0]=t,this[1]=e,this[2]=o,this[3]=f,this[4]=r,this[5]=i,this[6]=u,this[7]=M,this[8]=n,this[9]=h,this[10]=c,this[11]=m,this[12]=s,this[13]=a,this[14]=l,this[15]=g,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(hn)}fromObject(t){return this.check()}fromQuaternion(t){return mr(this,t),this.check()}frustum(t){const{left:r,right:n,bottom:s,top:e,near:i=sn,far:h=en}=t;return h===1/0?function(t,r,n,s,e,i){const h=2*i/(n-r),a=2*i/(e-s),o=(n+r)/(n-r),u=(e+s)/(e-s),c=-1,l=-1,f=-2*i;t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=o,t[9]=u,t[10]=c,t[11]=l,t[12]=0,t[13]=0,t[14]=f,t[15]=0}(this,r,n,s,e,i):gr(this,r,n,s,e,i,h),this.check()}lookAt(t){const{eye:r,center:n=[0,0,0],up:s=[0,1,0]}=t;return Or(this,r,n,s),this.check()}ortho(t){const{left:r,right:n,bottom:s,top:e,near:i=sn,far:h=en}=t;return Er(this,r,n,s,e,i,h),this.check()}orthographic(t){const{fovy:r=rn,aspect:n=nn,focalDistance:s=1,near:e=sn,far:i=en}=t;cn(r);const h=r/2,a=s*Math.tan(h),o=a*n;return this.ortho({left:-o,right:o,bottom:-a,top:a,near:e,far:i})}perspective(t){const{fovy:r=45*Math.PI/180,aspect:n=1,near:s=.1,far:e=500}=t;return cn(r),dr(this,r,n,s,e),this.check()}determinant(){return er(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),s=1/n[0],e=1/n[1],i=1/n[2];return t[0]=this[0]*s,t[1]=this[1]*e,t[2]=this[2]*i,t[3]=0,t[4]=this[4]*s,t[5]=this[5]*e,t[6]=this[6]*i,t[7]=0,t[8]=this[8]*s,t[9]=this[9]*e,t[10]=this[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const n=this.getScale(r),s=1/n[0],e=1/n[1],i=1/n[2];return t[0]=this[0]*s,t[1]=this[1]*e,t[2]=this[2]*i,t[3]=this[4]*s,t[4]=this[5]*e,t[5]=this[6]*i,t[6]=this[8]*s,t[7]=this[9]*e,t[8]=this[10]*i,t}transpose(){return nr(this,this),this.check()}invert(){return sr(this,this),this.check()}multiplyLeft(t){return ir(this,t,this),this.check()}multiplyRight(t){return ir(this,this,t),this.check()}rotateX(t){return ur(this,this,t),this.check()}rotateY(t){return cr(this,this,t),this.check()}rotateZ(t){return lr(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return or(this,this,t,r),this.check()}scale(t){return ar(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return hr(this,this,t),this.check()}transform(t,r){return 4===t.length?(S(r=jr(r||[-0,-0,-0,-0],t,this),4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){const{length:n}=t;let s;switch(n){case 2:s=_(r||[-0,-0],t,this);break;case 3:s=gt(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return S(s,t.length),s}transformAsVector(t,r){let n;switch(t.length){case 2:n=H(r||[-0,-0],t,this);break;case 3:n=tt(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return S(n,t.length),n}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,n){return this.identity().translate([t,r,n])}}let on,un;function cn(t){if(t>2*Math.PI)throw Error("expected radians")}function ln(){const t=new N(4);return N!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function fn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Mn(t,r,n){n*=.5;const s=Math.sin(n);return t[0]=s*r[0],t[1]=s*r[1],t[2]=s*r[2],t[3]=Math.cos(n),t}function mn(t,r,n){const s=r[0],e=r[1],i=r[2],h=r[3],a=n[0],o=n[1],u=n[2],c=n[3];return t[0]=s*c+h*a+e*u-i*o,t[1]=e*c+h*o+i*a-s*u,t[2]=i*c+h*u+s*o-e*a,t[3]=h*c-s*a-e*o-i*u,t}function gn(t,r,n){n*=.5;const s=r[0],e=r[1],i=r[2],h=r[3],a=Math.sin(n),o=Math.cos(n);return t[0]=s*o+h*a,t[1]=e*o+i*a,t[2]=i*o-e*a,t[3]=h*o-s*a,t}function bn(t,r,n){n*=.5;const s=r[0],e=r[1],i=r[2],h=r[3],a=Math.sin(n),o=Math.cos(n);return t[0]=s*o-i*a,t[1]=e*o+h*a,t[2]=i*o+s*a,t[3]=h*o-e*a,t}function dn(t,r,n){n*=.5;const s=r[0],e=r[1],i=r[2],h=r[3],a=Math.sin(n),o=Math.cos(n);return t[0]=s*o+e*a,t[1]=e*o-s*a,t[2]=i*o+h*a,t[3]=h*o-i*a,t}function pn(t,r){const n=r[0],s=r[1],e=r[2];return t[0]=n,t[1]=s,t[2]=e,t[3]=Math.sqrt(Math.abs(1-n*n-s*s-e*e)),t}function En(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=Math.sqrt(n*n+s*s+e*e),a=Math.exp(i),o=h>0?a*Math.sin(h)/h:0;return t[0]=n*o,t[1]=s*o,t[2]=e*o,t[3]=a*Math.cos(h),t}function On(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=Math.sqrt(n*n+s*s+e*e),a=h>0?Math.atan2(h,i)/h:0;return t[0]=n*a,t[1]=s*a,t[2]=e*a,t[3]=.5*Math.log(n*n+s*s+e*e+i*i),t}function yn(t,r,n,s){const e=r[0],i=r[1],h=r[2],a=r[3];let o,u,c,l,f,M=n[0],m=n[1],g=n[2],b=n[3];return o=e*M+i*m+h*g+a*b,o<0&&(o=-o,M=-M,m=-m,g=-g,b=-b),1-o>q?(u=Math.acos(o),f=Math.sin(u),c=Math.sin((1-s)*u)/f,l=Math.sin(s*u)/f):(c=1-s,l=s),t[0]=c*e+l*M,t[1]=c*i+l*m,t[2]=c*h+l*g,t[3]=c*a+l*b,t}function xn(t,r){const n=r[0],s=r[1],e=r[2],i=r[3],h=n*n+s*s+e*e+i*i,a=h?1/h:0;return t[0]=-n*a,t[1]=-s*a,t[2]=-e*a,t[3]=i*a,t}function kn(t,r){return t[0]=-r[0],t[1]=-r[1],t[2]=-r[2],t[3]=r[3],t}function Ln(t,r){const n=r[0]+r[4]+r[8];let s;if(n>0)s=Math.sqrt(n+1),t[3]=.5*s,s=.5/s,t[0]=(r[5]-r[7])*s,t[1]=(r[6]-r[2])*s,t[2]=(r[1]-r[3])*s;else{let n=0;r[4]>r[0]&&(n=1),r[8]>r[3*n+n]&&(n=2);const e=(n+1)%3,i=(n+2)%3;s=Math.sqrt(r[3*n+n]-r[3*e+e]-r[3*i+i]+1),t[n]=.5*s,s=.5/s,t[3]=(r[3*e+i]-r[3*i+e])*s,t[e]=(r[3*e+n]+r[3*n+e])*s,t[i]=(r[3*i+n]+r[3*n+i])*s}return t}const Sn=wr,wn=Rr,Rn=qr,qn=Nr,Nn=Ar,An=mn,Tn=Ir,Pn=$r,Zn=zr,In=Cr,Yn=In,Xn=vr,Cn=Xn,vn=Wr,Wn=Vr;const $n=function(){const t=st(),r=it(1,0,0),n=it(0,1,0);return function(s,e,i){const h=Mt(e,i);return h<-.999999?(mt(t,r,e),Rt(t)<1e-6&&mt(t,n,e),ft(t,t),Mn(s,t,Math.PI),s):h>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(mt(t,e,i),s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=1+h,vn(s,s))}}(),zn=function(){const t=ln(),r=ln();return function(n,s,e,i,h,a){return yn(t,s,h,a),yn(r,e,i,a),yn(n,t,r,2*a*(1-a)),n}}(),jn=function(){const t=Ct();return function(r,n,s,e){return t[0]=s[0],t[3]=s[1],t[6]=s[2],t[1]=e[0],t[4]=e[1],t[7]=e[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],vn(r,Ln(r,t))}}();var _n=Object.freeze({__proto__:null,create:ln,identity:fn,setAxisAngle:Mn,getAxisAngle:function(t,r){const n=2*Math.acos(r[3]),s=Math.sin(n/2);return s>q?(t[0]=r[0]/s,t[1]=r[1]/s,t[2]=r[2]/s):(t[0]=1,t[1]=0,t[2]=0),n},getAngle:function(t,r){const n=Pn(t,r);return Math.acos(2*n*n-1)},multiply:mn,rotateX:gn,rotateY:bn,rotateZ:dn,calculateW:pn,exp:En,ln:On,pow:function(t,r,n){return On(t,r),Tn(t,t,n),En(t,t),t},slerp:yn,invert:xn,conjugate:kn,fromMat3:Ln,str:function(t){return`quat(${t[0]}, ${t[1]}, ${t[2]}, ${t[3]})`},clone:Sn,fromValues:wn,copy:Rn,set:qn,add:Nn,mul:An,scale:Tn,dot:Pn,lerp:Zn,length:In,len:Yn,squaredLength:Xn,sqrLen:Cn,normalize:vn,exactEquals:Wn,equals:function(t,r){return Math.abs($r(t,r))>=.999999},rotationTo:$n,sqlerp:zn,setAxes:jn});const Vn=[0,0,0,1];class Fn extends k{constructor(t=0,r=0,n=0,s=1){super(-0,-0,-0,-0),Array.isArray(t)&&1===arguments.length?this.copy(t):this.set(t,r,n,s)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,n,s){return this[0]=t,this[1]=r,this[2]=n,this[3]=s,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return Ln(this,t),this.check()}fromAxisRotation(t,r){return Mn(this,t,r),this.check()}identity(){return fn(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=L(t)}get y(){return this[1]}set y(t){this[1]=L(t)}get z(){return this[2]}set z(t){this[2]=L(t)}get w(){return this[3]}set w(t){this[3]=L(t)}len(){return In(this)}lengthSquared(){return Xn(this)}dot(t){return Pn(this,t)}rotationTo(t,r){return $n(this,t,r),this.check()}add(t){return Nn(this,this,t),this.check()}calculateW(){return pn(this,this),this.check()}conjugate(){return kn(this,this),this.check()}invert(){return xn(this,this),this.check()}lerp(t,r,n){return void 0===n?this.lerp(this,t,r):(Zn(this,t,r,n),this.check())}multiplyRight(t){return mn(this,this,t),this.check()}multiplyLeft(t){return mn(this,t,this),this.check()}normalize(){const t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,0===t&&(this[3]=1),this.check()}rotateX(t){return gn(this,this,t),this.check()}rotateY(t){return bn(this,this,t),this.check()}rotateZ(t){return dn(this,this,t),this.check()}scale(t){return Tn(this,this,t),this.check()}slerp(t,r,n){let s,e,i;switch(arguments.length){case 1:({start:s=Vn,target:e,ratio:i}=t);break;case 2:s=this,e=t,i=r;break;default:s=t,e=r,i=n}return yn(this,s,e,i),this.check()}transformVector4(t,r=new Yt){return _r(r,t,this),S(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}const Dn=1e-6;class Kn{constructor({phi:t=0,theta:r=0,radius:n=1,bearing:s,pitch:e,altitude:i,radiusScale:h=6371e3}={}){this.phi=t,this.theta=r,this.radius=n||i||1,this.radiusScale=h||1,void 0!==s&&(this.bearing=s),void 0!==e&&(this.pitch=e),this.check()}toString(){return this.formatString(n)}formatString({printTypes:t=!1}){const r=e;return`${t?"Spherical":""}[rho:${r(this.radius)},theta:${r(this.theta)},phi:${r(this.phi)}]`}equals(t){return E(this.radius,t.radius)&&E(this.theta,t.theta)&&E(this.phi,t.phi)}exactEquals(t){return this.radius===t.radius&&this.theta===t.theta&&this.phi===t.phi}get bearing(){return 180-c(this.phi)}set bearing(t){this.phi=Math.PI-u(t)}get pitch(){return c(this.theta)}set pitch(t){this.theta=u(t)}get longitude(){return c(this.phi)}get latitude(){return c(this.theta)}get lng(){return c(this.phi)}get lat(){return c(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(t,r,n){return this.radius=t,this.phi=r,this.theta=n,this.check()}clone(){return(new Kn).copy(this)}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this.check()}fromLngLatZ([t,r,n]){return this.radius=1+n/this.radiusScale,this.phi=u(r),this.theta=u(t),this.check()}fromVector3(t){return this.radius=et(t),this.radius>0&&(this.theta=Math.atan2(t[0],t[1]),this.phi=Math.acos(d(t[2]/this.radius,-1,1))),this.check()}toVector3(){return new It(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(Dn,Math.min(Math.PI-Dn,this.phi)),this}check(){if(!(Number.isFinite(this.phi)&&Number.isFinite(this.theta)&&this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}const Bn="Unknown Euler angle order",Qn=.99999;var Un;!function(t){t[t.ZYX=0]="ZYX",t[t.YXZ=1]="YXZ",t[t.XZY=2]="XZY",t[t.ZXY=3]="ZXY",t[t.YZX=4]="YZX",t[t.XYZ=5]="XYZ"}(Un||(Un={}));class Jn extends k{static get ZYX(){return Un.ZYX}static get YXZ(){return Un.YXZ}static get XZY(){return Un.XZY}static get ZXY(){return Un.ZXY}static get YZX(){return Un.YZX}static get XYZ(){return Un.XYZ}static get RollPitchYaw(){return Un.ZYX}static get DefaultOrder(){return Un.ZYX}static get RotationOrders(){return Un}static rotationOrder(t){return Un[t]}get ELEMENTS(){return 4}constructor(t=0,r=0,n=0,s=Jn.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(t,r,n,s)}fromQuaternion(t){const[r,n,s,e]=t,i=n*n,h=-2*(i+s*s)+1,a=2*(r*n+e*s);let o=-2*(r*s-e*n);const u=2*(n*s+e*r),c=-2*(r*r+i)+1;o=o>1?1:o,o=o<-1?-1:o;const l=Math.atan2(u,c),f=Math.asin(o),M=Math.atan2(a,h);return this.set(l,f,M,Jn.RollPitchYaw)}fromObject(t){throw new Error("not implemented")}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=Number.isFinite(t[3])||this.order,this.check()}set(t=0,r=0,n=0,s){return this[0]=t,this[1]=r,this[2]=n,this[3]=Number.isFinite(s)?s:this[3],this.check()}validate(){return(t=this[3])>=0&&t<6&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2]);var t}toArray(t=[],r=0){return t[r]=this[0],t[r+1]=this[1],t[r+2]=this[2],t}toArray4(t=[],r=0){return t[r]=this[0],t[r+1]=this[1],t[r+2]=this[2],t[r+3]=this[3],t}toVector3(t=[-0,-0,-0]){return t[0]=this[0],t[1]=this[1],t[2]=this[2],t}get x(){return this[0]}set x(t){this[0]=L(t)}get y(){return this[1]}set y(t){this[1]=L(t)}get z(){return this[2]}set z(t){this[2]=L(t)}get alpha(){return this[0]}set alpha(t){this[0]=L(t)}get beta(){return this[1]}set beta(t){this[1]=L(t)}get gamma(){return this[2]}set gamma(t){this[2]=L(t)}get phi(){return this[0]}set phi(t){this[0]=L(t)}get theta(){return this[1]}set theta(t){this[1]=L(t)}get psi(){return this[2]}set psi(t){this[2]=L(t)}get roll(){return this[0]}set roll(t){this[0]=L(t)}get pitch(){return this[1]}set pitch(t){this[1]=L(t)}get yaw(){return this[2]}set yaw(t){this[2]=L(t)}get order(){return this[3]}set order(t){this[3]=function(t){if(t<0&&t>=6)throw new Error(Bn);return t}(t)}fromVector3(t,r){return this.set(t[0],t[1],t[2],Number.isFinite(r)?r:this[3])}fromArray(t,r=0){return this[0]=t[0+r],this[1]=t[1+r],this[2]=t[2+r],void 0!==t[3]&&(this[3]=t[3]),this.check()}fromRollPitchYaw(t,r,n){return this.set(t,r,n,Un.ZYX)}fromRotationMatrix(t,r=Jn.DefaultOrder){return this._fromRotationMatrix(t,r),this.check()}getRotationMatrix(t){return this._getRotationMatrix(t)}getQuaternion(){const t=new Fn;switch(this[3]){case Un.XYZ:return t.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case Un.YXZ:return t.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case Un.ZXY:return t.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case Un.ZYX:return t.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case Un.YZX:return t.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case Un.XZY:return t.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(Bn)}}_fromRotationMatrix(t,r=Jn.DefaultOrder){const n=t[0],s=t[4],e=t[8],i=t[1],h=t[5],a=t[9],o=t[2],u=t[6],c=t[10];switch(r=r||this[3]){case Jn.XYZ:this[1]=Math.asin(d(e,-1,1)),Math.abs(e)<Qn?(this[0]=Math.atan2(-a,c),this[2]=Math.atan2(-s,n)):(this[0]=Math.atan2(u,h),this[2]=0);break;case Jn.YXZ:this[0]=Math.asin(-d(a,-1,1)),Math.abs(a)<Qn?(this[1]=Math.atan2(e,c),this[2]=Math.atan2(i,h)):(this[1]=Math.atan2(-o,n),this[2]=0);break;case Jn.ZXY:this[0]=Math.asin(d(u,-1,1)),Math.abs(u)<Qn?(this[1]=Math.atan2(-o,c),this[2]=Math.atan2(-s,h)):(this[1]=0,this[2]=Math.atan2(i,n));break;case Jn.ZYX:this[1]=Math.asin(-d(o,-1,1)),Math.abs(o)<Qn?(this[0]=Math.atan2(u,c),this[2]=Math.atan2(i,n)):(this[0]=0,this[2]=Math.atan2(-s,h));break;case Jn.YZX:this[2]=Math.asin(d(i,-1,1)),Math.abs(i)<Qn?(this[0]=Math.atan2(-a,h),this[1]=Math.atan2(-o,n)):(this[0]=0,this[1]=Math.atan2(e,c));break;case Jn.XZY:this[2]=Math.asin(-d(s,-1,1)),Math.abs(s)<Qn?(this[0]=Math.atan2(u,h),this[1]=Math.atan2(e,n)):(this[0]=Math.atan2(-a,c),this[1]=0);break;default:throw new Error(Bn)}return this[3]=r,this}_getRotationMatrix(t){const r=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=this.x,s=this.y,e=this.z,i=Math.cos(n),h=Math.cos(s),a=Math.cos(e),o=Math.sin(n),u=Math.sin(s),c=Math.sin(e);switch(this[3]){case Jn.XYZ:{const t=i*a,n=i*c,s=o*a,e=o*c;r[0]=h*a,r[4]=-h*c,r[8]=u,r[1]=n+s*u,r[5]=t-e*u,r[9]=-o*h,r[2]=e-t*u,r[6]=s+n*u,r[10]=i*h;break}case Jn.YXZ:{const t=h*a,n=h*c,s=u*a,e=u*c;r[0]=t+e*o,r[4]=s*o-n,r[8]=i*u,r[1]=i*c,r[5]=i*a,r[9]=-o,r[2]=n*o-s,r[6]=e+t*o,r[10]=i*h;break}case Jn.ZXY:{const t=h*a,n=h*c,s=u*a,e=u*c;r[0]=t-e*o,r[4]=-i*c,r[8]=s+n*o,r[1]=n+s*o,r[5]=i*a,r[9]=e-t*o,r[2]=-i*u,r[6]=o,r[10]=i*h;break}case Jn.ZYX:{const t=i*a,n=i*c,s=o*a,e=o*c;r[0]=h*a,r[4]=s*u-n,r[8]=t*u+e,r[1]=h*c,r[5]=e*u+t,r[9]=n*u-s,r[2]=-u,r[6]=o*h,r[10]=i*h;break}case Jn.YZX:{const t=i*h,n=i*u,s=o*h,e=o*u;r[0]=h*a,r[4]=e-t*c,r[8]=s*c+n,r[1]=c,r[5]=i*a,r[9]=-o*a,r[2]=-u*a,r[6]=n*c+s,r[10]=t-e*c;break}case Jn.XZY:{const t=i*h,n=i*u,s=o*h,e=o*u;r[0]=h*a,r[4]=-c,r[8]=u*a,r[1]=t*c+e,r[5]=i*a,r[9]=n*c-s,r[2]=s*c-n,r[6]=o*a,r[10]=e*c+t;break}default:throw new Error(Bn)}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}toQuaternion(){const t=Math.cos(.5*this.yaw),r=Math.sin(.5*this.yaw),n=Math.cos(.5*this.roll),s=Math.sin(.5*this.roll),e=Math.cos(.5*this.pitch),i=Math.sin(.5*this.pitch);return new Fn(t*s*e-r*n*i,t*n*i+r*s*e,r*n*e-t*s*i,t*n*e+r*s*i)}}class Gn{constructor({x:t=0,y:r=0,z:n=0,roll:s=0,pitch:e=0,yaw:i=0,position:h,orientation:a}={}){Array.isArray(h)&&3===h.length?this.position=new It(h):this.position=new It(t,r,n),Array.isArray(a)&&4===a.length?this.orientation=new Jn(a,a[3]):this.orientation=new Jn(s,e,i,Jn.RollPitchYaw)}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}get z(){return this.position.z}set z(t){this.position.z=t}get roll(){return this.orientation.roll}set roll(t){this.orientation.roll=t}get pitch(){return this.orientation.pitch}set pitch(t){this.orientation.pitch=t}get yaw(){return this.orientation.yaw}set yaw(t){this.orientation.yaw=t}getPosition(){return this.position}getOrientation(){return this.orientation}equals(t){return!!t&&(this.position.equals(t.position)&&this.orientation.equals(t.orientation))}exactEquals(t){return!!t&&(this.position.exactEquals(t.position)&&this.orientation.exactEquals(t.orientation))}getTransformationMatrix(){const t=Math.sin(this.roll),r=Math.sin(this.pitch),n=Math.sin(this.yaw),s=Math.cos(this.roll),e=Math.cos(this.pitch),i=Math.cos(this.yaw);return(new an).setRowMajor(i*e,-n*s+i*r*t,n*t+i*r*s,this.x,n*e,i*s+n*r*t,-i*t+n*r*s,this.y,-r,e*t,e*s,this.z,0,0,0,1)}getTransformationMatrixFromPose(t){return(new an).multiplyRight(this.getTransformationMatrix()).multiplyRight(t.getTransformationMatrix().invert())}getTransformationMatrixToPose(t){return(new an).multiplyRight(t.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}const Hn=Math.PI/2,ts=Math.PI/4,rs=Math.PI/6,ns=2*Math.PI;var ss=Object.freeze({__proto__:null,EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Hn,PI_OVER_FOUR:ts,PI_OVER_SIX:rs,TWO_PI:ns});export{Jn as Euler,Gt as Matrix3,an as Matrix4,Gn as Pose,Fn as Quaternion,Kn as SphericalCoordinates,nt as Vector2,It as Vector3,Yt as Vector4,Jn as _Euler,ss as _MathUtils,Gn as _Pose,Kn as _SphericalCoordinates,g as acos,m as asin,w as assert,b as atan,d as clamp,h as clone,n as config,s as configure,f as cos,c as degrees,E as equals,O as exactEquals,e as formatValue,i as isArray,p as lerp,Ut as mat3,Lr as mat4,_n as quat,u as radians,l as sin,M as tan,o as toDegrees,a as toRadians,G as vec2,At as vec3,tn as vec4,y as withEpsilon};export default null;
//# sourceMappingURL=/sm/e9204fcb05d32a8a8666a42d33958fab5d1348a03c1f420ef3f18327b76b821f.map